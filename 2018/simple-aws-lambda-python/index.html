<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Stanley Zheng"><meta name=description content="Programmer Blog, trying to share insights and knowledge picked up along the way."><meta name=generator content="Hugo 0.58.3"><title>AWS Lambda with Python &middot; Stanley Zheng</title><link rel="shortcut icon" href=https://stanzheng.com/blog/images/favicon.ico><link rel=stylesheet href=https://stanzheng.com/blog/css/style.css><link rel=stylesheet href=https://stanzheng.com/blog/css/highlight.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css><link href=https://stanzheng.com/blog/index.xml rel=alternate type=application/rss+xml title="Stanley Zheng"></head><body><nav class=main-nav><a href=https://stanzheng.com/blog/>Home</a>
<a href=https://stanzheng.com/>About</a>
<a class=cta href=https://tinyletter.com/stanzheng>Join My TinyLetter!</a></nav><section id=wrapper><article class=post><header><h1>AWS Lambda with Python</h1><h2 class=headline>January 23, 2018<br><a href=https://stanzheng.com/blog/tags/aws>AWS</a>
<a href=https://stanzheng.com/blog/tags/python>Python</a></h2></header><section id=post-body><h3 id=update>Update</h3><p>The bundle of this code is interesting but the bundle is huge! I recommend trying out either of the solutions below.</p><ul><li><a href=https://serverless.com/>Serverless Framework</a></li><li><a href=https://docs.aws.amazon.com/lambda/latest/dg/serverless_app.html>AWS Serverless Application Model</a></li></ul><h3 id=intro>Intro</h3><p><a href=https://aws.amazon.com/lambda/>AWS Lambda</a> is a hosted platform for running code in the Amazon ecosystem. It supports multiple runtimes including Python! I found that although writing the logic code is easy, there are some unintuitive things that I&rsquo;ve stumbled over.</p><p>There are three ways you can get your code to Amazon lambda.</p><ul><li>their inline editor</li><li>S3://Bucket</li><li>Zipped up</li></ul><p>The below repo has a preconfigured way to clone a repo, and demonstrate adding packages to run on AWS Lambda quickly.</p><ul><li>1) Setup an AWS Account and CLI on your machine</li><li>2) Provision an AWS Lambda with role <code>AWSLambdaFullAccess</code></li><li>3) Create your function with a unique name from the interface</li></ul><p>Use the starting point of <a href=https://github.com/4projects/python-lambda-template>https://github.com/4projects/python-lambda-template</a> and update <code>App.py</code></p><h3 id=update-code>UPDATE CODE</h3><pre><code>zip -g App.zip *.py
aws lambda update-function-code --function-name $FUNCTION_NAME --zip-file fileb://App.zip
</code></pre><p><strong>Note</strong> Also update your app handler from <code>Main.handler</code> to something like <code>App.handler</code>.</p><h2 id=detailed-writeup>Detailed Writeup</h2><p>What the application example does in <code>App.py</code> does is visits a website, copies down the data (presuming its <code>json</code>) and inserts it in DynamoDB. The DynamoDB was also created ahead of time through the AWS interface and an example of this can be used for any json feed.</p><h2 id=building-the-bundle>Building the bundle</h2><p>This is how the bundle was built and can be rebuilt. Additional packages can be added in it.</p><h3 id=packaging-and-uploading-your-bundle>Packaging and uploading your bundle</h3><p>You need to package third-party dependencies. The least painful way is to set up a virtualenv. <code>pyenv</code> comes packaged with python3 so after you create a new directory you can do that with:</p><pre><code>mkdir APP_NAME &amp;&amp; cd APP_NAME
python3 -m venv .
</code></pre><p>Then you have to activate your virtual environment. Depending on your terminal pick the appropriate extension.To activate your virtual environment you would use <code>bin/activate</code>. If you&rsquo;re using fish shell, you can use <code>bin/activate.fish</code>.</p><p>after your <code>APP_NAME</code> directory should look like:</p><pre><code>ls . 
&gt; bin        include    lib        pyvenv.cfg
</code></pre><p>Now install packages to your heart&rsquo;s content. creating a few dependencies or common libs you rely on is wise.</p><p><code>pip install requests</code></p><p>Then changing directory to the <code>site-packages</code> in your <code>lib</code> folder. My directory path happens to be <code>$VIRTUAL_ENV/lib/python3.6/site-packages</code>.</p><p>Zip it up <code>zip -r9 App.zip $VIRTUAL_ENV/lib/python3.6/site-packages</code>.</p></section></article><footer id=post-meta class=clearfix><a href=https://twitter.com/stanzheng><img class=avatar src="https://avatars0.githubusercontent.com/u/3683993?v=3&s=466"><div><span class=dark>Stanley Zheng</span>
<span>Polyglot who loves to experiment and explore</span>
<span><i class=rc-scout></i>Want to become a better programmer? <a href="https://www.recurse.com/scout/click?t=710ee58e0b0ad8d9f443f9c9440137f1">Join the Recurse Center!</a></span></div></a><section id=sharing><a class=twitter href="https://twitter.com/intent/tweet?text=https%3a%2f%2fstanzheng.com%2fblog%2f2018%2fsimple-aws-lambda-python%2f - AWS%20Lambda%20with%20Python by @stanzheng"><span class=icon-twitter>Tweet</span></a></section></footer><ul id=post-list class="archive readmore"><h3>Read more</h3><li><a href=https://stanzheng.com/blog/2018/>2018s<aside class=dates>Jul 28</aside></a></li><li><a href=https://stanzheng.com/blog/tags/certifications/>Certifications<aside class=dates>Jul 28</aside></a></li><li><a href=https://stanzheng.com/blog/tags/gcp/>GCP<aside class=dates>Jul 28</aside></a></li></ul><footer id=footer><div id=social><a class=symbol href=https://www.github.com/stanzheng><i class="fa fa-github"></i></a><a class=symbol href=https://www.instagram.com/yostanzheng><i class="fa fa-instagram"></i></a><a class=symbol href=/index.xml><i class="fa fa-rss"></i></a><a class=symbol href=https://www.twitter.com/stanzheng><i class="fa fa-twitter"></i></a></div><p class=small>Â© Copyright 2019 Stanley Zheng</p></footer></section><script src=//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js></script><script src=https://stanzheng.com/blog/js/main.js></script><script src=https://stanzheng.com/blog/js/highlight.js></script><script>hljs.initHighlightingOnLoad();</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-73744856-3','auto');ga('send','pageview');}</script></body></html>